<app-header context="friends" (filterChanged)="onFilterChanged($event)"></app-header>

<!-- Показать контент, если фильтр 'all' -->
<div class="p-6" *ngIf="filter === 'all'">

  <!-- Заголовок для поиска -->
  <h2 class="text-2xl font-semibold mb-2 text-white">Добавить в друзья</h2>
  <span class="font-light text-white">Вы можете добавить друга по имени пользователя</span>

  <!-- Поле ввода и кнопка поиска -->
  <div class="flex items-center space-x-2 mt-6">
    <input
      [(ngModel)]="username"
      (keyup.enter)="searchFriends()"
      (input)="onUsernameChange()"
      placeholder="Введите никнейм"
      class="w-full p-3 border border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-red-500 text-black"
    />
  </div>

  <!-- Список найденных пользователей -->
  <ul *ngIf="foundUsers.length > 0" class="divide-y divide-gray-600 mt-4">
    <li
      *ngFor="let user of foundUsers"
      class="flex items-center justify-between p-4 hover:bg-gray-700 rounded-lg transition"
    >
      <div class="flex items-center space-x-3">
        <img
          [src]="user.avatar || 'avatars/default-avatar.png'"
          alt="User avatar"
          class="w-10 h-10 rounded-full"
        />
        <span class="text-lg font-medium text-white">{{ user.username }}</span>
      </div>
      <button
        *ngIf="!isUserAdded(user.id)"
        (click)="sendFriendRequest(user.id, user)"
        class="px-4 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600 transition"
      >
        Добавить
      </button>
      <!-- Сообщение, если пользователь уже добавлен -->
      <span *ngIf="isUserAdded(user.id)" class="text-gray-500 text-sm">Уже добавлен</span>
    </li>
  </ul>

  <!-- Сообщение, если пользователи не найдены -->
  <p *ngIf="foundUsers.length === 0 && username" class="text-center text-gray-500 mt-4">
    Пользователи не найдены
  </p>

</div>

<div *ngIf="showNotification" class="fixed top-0 left-1/2 transform -translate-x-1/2 z-50 mt-5 w-96 p-4 rounded-lg"
     [ngClass]="{
       'bg-green-500 text-white': notificationType === 'success',
       'bg-red-500 text-white': notificationType === 'error'
     }">
  <p>{{ notificationMessage }}</p>
</div>

<!-- Рендеринг компонента для 'waiting' -->
<div *ngIf="filter === 'waiting'">
  <app-pending-friend-requests></app-pending-friend-requests>
</div>
